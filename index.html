<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>RefAliance ‚Äî –ø–æ–ª–Ω—ã–π</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />

<style>
/* === –ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π —Ç—ë–º–Ω–æ-—Å–∏–Ω–∏–π –¥–∏–∑–∞–π–Ω ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω === */
body {
  font-family: 'Poppins', Arial, sans-serif;
  margin: 0;
  background-color: #0a0f23;
  color: #ffffff;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* –æ–±—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä-—ç–∫—Ä–∞–Ω */
.screen {
  width: 100%;
  max-width: 600px;
  display: none;
  flex-direction: column;
  align-items: center;
  margin-top: 30px;
}

/* —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω (auth-choice) ‚Äî –≤–∏–¥–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
#auth-choice-screen { display:flex; flex-direction:column; align-items:center; }

/* –ª–æ–≥–∏–Ω/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è */
.login-box {
  background: linear-gradient(145deg,#0f1a36,#182147);
  padding: 25px 20px;
  border-radius: 14px;
  display: flex;
  flex-direction: column;
  align-items: center;
  box-shadow: 0 6px 20px rgba(0,0,0,0.7);
}
.login-box input {
  padding: 10px;
  margin: 8px 0;
  border-radius: 8px;
  border: none;
  width: 220px;
  font-size: 15px;
}
.login-box button {
  padding: 8px 15px;
  border: none;
  border-radius: 14px;
  background: linear-gradient(135deg,#001f4d,#003366);
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
  width: 140px;
  margin-top: 8px;
}
.login-box button:hover { transform: translateY(-2px); box-shadow: 0 0 12px #002b70,0 0 20px #004080; }

/* navbar */
.navbar {
  width: 100%;
  background: linear-gradient(90deg,#00102b,#001f4d);
  color: white;
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-sizing: border-box;
  box-shadow: 0 2px 6px rgba(0,0,0,0.7);
}
.user-info { display: flex; gap: 20px; font-weight: bold; }
#navbar-br { color: gold; font-weight: bold; text-shadow: 0 0 5px gold, 0 0 10px orange; }

/* –∫—Ä—É–≥ —Å –¥–≤–æ—Ä—Ü–æ–º ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω */
.emoji-circle {
  margin: 25px 0 15px;
  width: 260px;
  height: 260px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  position: relative;
  background: radial-gradient(circle at center, #001a40, #001f4d);
  animation: neonPulse 2s infinite alternate;
  box-shadow: 0 0 20px #001f4d,0 0 40px #002b70;
}
.emoji-circle img { width: 85%; height: 85%; object-fit: contain; }
@keyframes neonPulse { 0% { box-shadow: 0 0 10px #001f4d,0 0 12px #002b70; } 100% { box-shadow: 0 0 14px #001f4d,0 0 18px #002b70; } }

/* —É—Ä–æ–≤–µ–Ω—å (10 —á–µ–ª–æ–≤–µ—á–∫–æ–≤) + –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å */
.level-container { display:flex; align-items:center; gap:8px; margin-bottom:20px; }
.level-bar { display:flex; justify-content:center; gap:5px; font-size:18px; }
.level-bar span { opacity:0.15; transition:opacity 0.3s; }
.level-bar span.active { opacity:1; text-shadow:0 0 4px #fff,0 0 7px #0ff; }
.level-progress { height:16px; width:120px; border-radius:8px; background: linear-gradient(90deg,#004080,#0070c0); display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:bold; color:#fff; }

/* –∫–Ω–æ–ø–∫–∏ 3x2 */
.button-container { display:grid; grid-template-columns: repeat(3,1fr); gap:12px; margin-bottom:20px; padding:0 15px; width:100%; max-width:500px; box-sizing:border-box; }
.neon {
  padding:10px; font-size:14px; border:none; border-radius:14px; cursor:pointer; font-weight:bold; color:#fff;
  background: linear-gradient(145deg, #001f4d,#003366); text-align:center; transition: transform 0.3s, box-shadow 0.3s;
  box-shadow: 0 0 4px rgba(0,80,160,0.2), 0 0 6px rgba(0,50,120,0.2);
}
.neon:hover { transform: translateY(-2px); box-shadow: 0 0 8px rgba(0,80,160,0.5), 0 0 12px rgba(0,50,120,0.5); }

/* –∫–æ–Ω—Ç–µ–Ω—Ç-–±–ª–æ–∫ */
.content {
  width: calc(100% - 30px);
  background: linear-gradient(145deg,#00102b,#001f4d);
  padding:20px;
  margin:0 15px;
  border-radius:14px;
  box-shadow:0 4px 20px rgba(0,0,0,0.7);
  min-height:150px;
  box-sizing:border-box;
  position:relative;
  overflow-x:auto;
}

/* –ø–æ–¥-–∫–Ω–æ–ø–∫–∏ */
.sub-buttons { display:flex; gap:10px; margin-top:15px; justify-content:flex-start; flex-wrap:wrap; }
.sub-buttons button { flex:1 1 100px; background: linear-gradient(145deg,#001f4d,#003366); color:#fff; font-weight:bold; border-radius:10px; border:none; padding:8px; cursor:pointer; box-shadow:0 0 4px #002b70,0 0 6px #004080; transition: transform 0.2s, box-shadow 0.2s; }
.sub-buttons button:hover { transform: translateY(-2px); box-shadow:0 0 8px #002b70,0 0 12px #004080; }

.toggle-buttons { display:flex; gap:15px; margin-bottom:15px; }
.toggle-buttons button { flex:1; background: linear-gradient(145deg,#001f4d,#003366); color:#fff; font-weight:bold; border:none; border-radius:14px; padding:8px; cursor:pointer; transition:0.3s; }
.toggle-buttons button:hover { box-shadow:0 0 8px #002b70,0 0 12px #004080; }

/* —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ */
table { width:100%; border-collapse: collapse; margin-top:10px; color:#fff; }
th, td { border:1px solid rgba(255,255,255,0.2); padding:6px; text-align:center; }
th { background: rgba(255,255,255,0.05); }

/* —Å–µ—Ç–∫–∞ –∑–µ–º–µ–ª—å 3x3 */
.shop-grid { display:grid; grid-template-columns: repeat(3,1fr); gap:8px; margin-top:10px; }
.shop-grid div { background-color:#002b70; opacity:0.1; width:40px; height:40px; border-radius:4px; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:bold; cursor:pointer; transition:0.3s; }
.shop-grid div.owned { opacity:1; background: linear-gradient(145deg,#003366,#0055a0); }

/* –∞–¥–∞–ø—Ç–∏–≤ */
@media(max-width:500px){ .button-container { grid-template-columns: repeat(2,1fr); } .emoji-circle{width:220px;height:220px;} }
</style>
</head>
<body>

<!-- === —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω: —Ç–æ–ª—å–∫–æ –æ–Ω –∏–∑–º–µ–Ω—ë–Ω (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + RefAliance + –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏) === -->
<div class="screen" id="auth-choice-screen" style="display:flex; flex-direction:column; align-items:center;">
  <div style="background: linear-gradient(160deg,#0f1a36,#182147); padding:20px; border-radius:12px; display:flex; flex-direction:column; align-items:center; box-shadow:0 6px 18px rgba(0,0,0,0.65);">
    <!-- –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∏–∑ —Ä–µ–ø–æ (–∏—Å–ø–æ–ª—å–∑—É–µ–º raw URL, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ) -->
    <img src="https://raw.githubusercontent.com/vanisan111/app/app/king.png" alt="King" style="max-width:180px; margin-bottom:14px; display:block;">
    <!-- –∑–∞–≥–æ–ª–æ–≤–æ–∫ RefAliance –∑–æ–ª–æ—Ç—ã–º -->
    <h2 style="margin:0 0 14px; color:gold; text-shadow:0 0 10px rgba(255,215,0,0.9); font-size:26px;">RefAliance</h2>

    <!-- –∫–Ω–æ–ø–∫–∏ –æ–¥–Ω–∞ –ø–æ–¥ –¥—Ä—É–≥–æ–π -->
    <div class="toggle-buttons" style="flex-direction:column; width:100%; align-items:center;">
      <button onclick="showForm('login')" style="width:220px; margin-bottom:8px;">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</button>
      <button onclick="showForm('register')" style="width:220px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
    </div>
  </div>
</div>

<!-- === Login —ç–∫—Ä–∞–Ω (–Ω–µ —Ç—Ä–æ–Ω—É—Ç) === -->
<div class="screen" id="login-screen">
  <div class="login-box">
    <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
    <input type="text" id="login-username" placeholder="–õ–æ–≥–∏–Ω">
    <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å">
    <div style="display:flex; gap:10px; margin-top:10px;">
      <button onclick="login()">–í–æ–π—Ç–∏</button>
      <button onclick="backToChoice()">–ù–∞–∑–∞–¥</button>
    </div>
  </div>
</div>

<!-- === Register —ç–∫—Ä–∞–Ω (–Ω–µ —Ç—Ä–æ–Ω—É—Ç) === -->
<div class="screen" id="register-screen">
  <div class="login-box">
    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input type="text" id="reg-username" placeholder="–õ–æ–≥–∏–Ω">
    <input type="password" id="reg-password" placeholder="–ü–∞—Ä–æ–ª—å">
    <input type="text" id="reg-alliance" placeholder="–ò–º—è –∞–ª—å—è–Ω—Å–∞">
    <div style="display:flex; gap:10px; margin-top:10px;">
      <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      <button onclick="backToChoice()">–ù–∞–∑–∞–¥</button>
    </div>
  </div>
</div>

<!-- === –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (–ø–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω) === -->
<div class="screen" id="main-screen">
  <div class="navbar">
    <div id="navbar-username">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
    <div class="user-info">
      <div id="navbar-level">üèÜ Lv.1</div>
      <div id="navbar-referrals">üë• 0</div>
      <div id="navbar-br">‚öîÔ∏è BR: 100</div>
    </div>
  </div>

  <div class="emoji-circle">
    <!-- –¥–≤–æ—Ä–µ—Ü (raw URL) -->
    <img src="https://raw.githubusercontent.com/vanisan111/app/app/castle.png" alt="–î–≤–æ—Ä–µ—Ü">
  </div>

  <div class="level-container">
    <div class="level-bar" id="level-bar"></div>
    <div class="level-progress" id="level-progress">0 / 10</div>
  </div>

  <div class="button-container">
    <button class="neon" onclick="showContent('palace')">–î–≤–æ—Ä–µ—Ü</button>
    <button class="neon" onclick="showContent('referrals')">–†–µ—Ñ–µ—Ä–∞–ª—ã</button>
    <button class="neon" onclick="showContent('balance')">–ë–∞–ª–∞–Ω—Å</button>
    <button class="neon" onclick="showContent('rating')">–†–µ–π—Ç–∏–Ω–≥</button>
    <button class="neon" onclick="showContent('shop')">–ú–∞–≥–∞–∑–∏–Ω</button>
    <button class="neon" onclick="showContent('rules')">–ü—Ä–∞–≤–∏–ª–∞</button>
  </div>

  <div class="content" id="content-box">
    –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã
  </div>
</div>

<script>
/* === –õ–æ–≥–∏–∫–∞ (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∞) === */
let balance = 10;                     // —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å
let BR = 100;                         // –±–æ–µ–≤–æ–π —Ä–µ–π—Ç–∏–Ω–≥
let level = 0;                        // —É—Ä–æ–≤–µ–Ω—å (—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ—á–∫–æ–≤ –∞–∫—Ç–∏–≤–Ω—ã)
let playerID = Math.floor(Math.random()*90000 + 10000); // –ø—Å–µ–≤–¥–æ-ID –∏–≥—Ä–æ–∫–∞
let referrals = {};                   // {refId: name}
let lands = [true,false,false,false,false,false,false,false,false]; // 3x3 ‚Äî –ø–µ—Ä–≤–∞—è –∑–µ–º–ª—è –∫—É–ø–ª–µ–Ω–∞
// next land cost formula: 5 * ownedCount (ownedCount starts = 1 so first buy = 5 TON)

function showForm(type){
  // —Å–∫—Ä—ã—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—ã–π, –ø–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏–Ω/—Ä–µ–≥
  document.getElementById('auth-choice-screen').style.display='none';
  if(type === 'login') document.getElementById('login-screen').style.display='flex';
  else document.getElementById('register-screen').style.display='flex';
}

function backToChoice(){
  // —Å–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—ã –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ä—Ç
  document.getElementById('login-screen').style.display='none';
  document.getElementById('register-screen').style.display='none';
  document.getElementById('auth-choice-screen').style.display='flex';
}

function renderLevel(current, max=10){
  level = current;
  const bar = document.getElementById('level-bar');
  const progress = document.getElementById('level-progress');
  bar.innerHTML = '';
  for(let i=1;i<=max;i++){
    const s = document.createElement('span');
    s.innerText = 'üë§';
    if(i <= current) s.classList.add('active');
    bar.appendChild(s);
  }
  progress.innerText = current + ' / ' + max;
}

function updateBR(){
  document.getElementById('navbar-br').innerText = '‚öîÔ∏è BR: ' + BR.toFixed(1);
}

function login(){
  const username = document.getElementById('login-username').value || '–ò–≥—Ä–æ–∫';
  document.getElementById('navbar-username').innerText = 'üë§ ' + username;
  document.getElementById('login-screen').style.display = 'none';
  document.getElementById('main-screen').style.display = 'flex';
  renderLevel(0,10);
  updateBR();
}

function register(){
  const username = document.getElementById('reg-username').value || '–ò–≥—Ä–æ–∫';
  const alliance = document.getElementById('reg-alliance').value || '-';
  // –µ—Å–ª–∏ –≤ URL –±—ã–ª ref, —Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª–∞
  const urlParams = new URLSearchParams(window.location.search);
  const refID = urlParams.get('ref');
  if(refID){
    // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –ø–æ–¥ —ç—Ç–∏–º refID (–¥–µ–º–æ-–ª–æ–≥–∏–∫–∞ ‚Äî –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è)
    referrals[refID] = username;
  }
  document.getElementById('navbar-username').innerText = 'üë§ ' + username + ' [' + alliance + ']';
  document.getElementById('register-screen').style.display = 'none';
  document.getElementById('main-screen').style.display = 'flex';
  renderLevel(0,10);
  updateBR();
}

/* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–∫–ª–∞–¥–æ–∫ */
function showContent(type){
  const contentBox = document.getElementById('content-box');
  contentBox.innerHTML = '<div id="main-text"></div>';
  const mainText = document.getElementById('main-text');

  if(type === 'palace'){
    mainText.innerHTML = `‚ÑπÔ∏è <b>–î–≤–æ—Ä–µ—Ü</b><br><br>
      üë§ –ò–º—è: ${document.getElementById("navbar-username").innerText.replace("üë§ ","")}<br>
      ü§ù –†–µ—Ñ–µ—Ä –º–∞—Å—Ç–µ—Ä: - <br>
      üí∞ –ë–∞–ª–∞–Ω—Å (TON): ${balance}<br>
      üìÖ –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${new Date().toLocaleDateString()}<br>
      üÜî Telegram ID: #${playerID}<br>
      ‚öîÔ∏è BR: ${BR.toFixed(1)}`;
  }
  else if(type === 'referrals'){
    mainText.innerHTML = `üë• <b>–†–µ—Ñ–µ—Ä–∞–ª—ã</b><br><br>
      –í–∞—à ID: <input type="text" id="player-id" value="${playerID}" readonly style="width:120px;">
      <button onclick="copyReferral()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
      <div id="ref-list" style="margin-top:10px;"></div>`;
    updateReferralList();
  }
  else if(type === 'balance'){
    mainText.innerHTML = `üí∞ <b>–ë–∞–ª–∞–Ω—Å</b><br><br> –í–∞—à –±–∞–ª–∞–Ω—Å: ${balance} TON.`;
    const sub = document.createElement('div');
    sub.className = 'sub-buttons';
    sub.innerHTML = `<button onclick="withdraw()">–í—ã–≤–æ–¥</button><button onclick="deposit()">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</button>`;
    contentBox.appendChild(sub);
  }
  else if(type === 'rating'){
    mainText.innerHTML = `üèÜ <b>–†–µ–π—Ç–∏–Ω–≥</b><br><br>`;
    const table = document.createElement('table');
    table.innerHTML = `<thead><tr><th>‚Ññ</th><th>–ò–º—è</th><th>–ë–æ–µ–≤–∞—è —Å–∏–ª–∞</th><th>–£—á–∞—Å—Ç–Ω–∏–∫–∏</th></tr></thead>
      <tbody>
      ${Array.from({length:10},(_,i)=>`<tr><td>${i+1}</td><td>–ò–≥—Ä–æ–∫${i+1}</td><td>${Math.floor(Math.random()*1000)+100}</td><td>${Math.floor(Math.random()*50)+1}</td></tr>`).join('')}
      </tbody>`;
    contentBox.appendChild(table);
  }
  else if(type === 'shop'){
    mainText.innerHTML = `üõí <b>–ú–∞–≥–∞–∑–∏–Ω</b><br><br>`;
    const shopDiv = document.createElement('div');
    shopDiv.className = 'sub-buttons';
    shopDiv.innerHTML = `
      <button onclick="buyItem(1,0.5,'–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–≤–æ—Ä—Ü–∞')">üè∞ –£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–≤–æ—Ä—Ü–∞ (1 TON ‚Üí +0.5% BR)</button>
      <button onclick="buyItem(2,1.5,'–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∞—Ä–º–∏–∏')">‚öîÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∞—Ä–º–∏–∏ (2 TON ‚Üí +1.5% BR)</button>
      <button onclick="buyItem(3,5,'–ú–∞–≥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞')">üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ (3 TON ‚Üí +5% BR)</button>
    `;
    contentBox.appendChild(shopDiv);

    // —Å–µ—Ç–∫–∞ –∑–µ–º–µ–ª—å 3x3
    const grid = document.createElement('div');
    grid.className = 'shop-grid';
    for(let i=0;i<9;i++){
      const cell = document.createElement('div');
      cell.innerText = 'üè°';
      if(lands[i]) cell.classList.add('owned');
      // –ø–æ–¥–ø–∏—Å—å —Ü–µ–Ω—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –¥–ª—è –Ω–µ–∑–∞–Ω—è—Ç—ã—Ö
      const ownedCount = lands.filter(x=>x).length;
      const nextCost = 5 * ownedCount; // –µ—Å–ª–∏ ownedCount=1 => cost 5
      if(!lands[i]) cell.title = `–ö—É–ø–∏—Ç—å –∑–∞ ${nextCost} TON`;
      cell.onclick = ()=> {
        buyLand(i);
      };
      grid.appendChild(cell);
    }
    contentBox.appendChild(grid);
  }
  else if(type === 'rules'){
    mainText.innerHTML = `<b>–ü—Ä–∞–≤–∏–ª–∞</b><br><br>
      –ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –≤ –∏–≥—Ä—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ.<br>
      –ü—Ä–∏ –∏–≥—Ä–µ –æ–Ω –ø–æ–ª—É—á–∞–µ—Ç —Ñ–µ–æ–¥ –≤ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–µ.<br>
      –ú–∞–∫—Å–∏–º—É–º 10 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤ TON.<br>
      –î–ª—è –≤—ã–≤–æ–¥–∞ –Ω—É–∂–Ω–æ —Å—Ç–∞—Ç—å –±–∞—Ä–æ–Ω–æ–º - –¥–æ–Ω–∞—Ç 7 TON.<br>
      –¢–∞–∫ –∂–µ –µ—Å—Ç—å –≤–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ –∏ NFT —Ç–æ—Ä–≥–æ–≤–ª—è.`;
  }
}

/* –ú–∞–≥–∞–∑–∏–Ω ‚Äî –ø–æ–∫—É–ø–∫–∏ */
function buyItem(cost, percent, name){
  if(balance < cost){ alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON'); return; }
  balance -= cost;
  BR += BR * (percent/100);
  updateBR();
  alert('–ö—É–ø–ª–µ–Ω–æ: ' + name);
  showContent('shop');
}

/* –†–µ—Ñ–µ—Ä–∞–ª—ã */
function copyReferral(){
  const link = `${window.location.origin}${window.location.pathname}?ref=${playerID}`;
  navigator.clipboard.writeText(link).then(()=>alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä'));
}
function updateReferralList(){
  const div = document.getElementById('ref-list');
  if(!div) return;
  const keys = Object.keys(referrals);
  if(keys.length===0) div.innerText = '–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤';
  else {
    div.innerHTML = '<ul>' + keys.map(k=>`<li>${k} ‚Üí ${referrals[k]}</li>`).join('') + '</ul>';
  }
}

/* –ë–∞–ª–∞–Ω—Å (–¥–µ–º–æ) */
function withdraw(){ alert('–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ (–¥–µ–º–æ)'); }
function deposit(){ balance += 5; alert('–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ +5 TON'); showContent('balance'); }

/* –ó–µ–º–ª–∏ */
function buyLand(index){
  if(lands[index]) return;
  const ownedCount = lands.filter(x=>x).length; // starts 1
  const cost = 5 * ownedCount; // first buy = 5 TON
  if(balance < cost){ alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∑–µ–º–ª–∏!'); return; }
  balance -= cost;
  lands[index] = true;
  alert(`–ö—É–ø–ª–µ–Ω–æ –ø–æ–ª–µ #${index+1} –∑–∞ ${cost} TON`);
  showContent('shop');
}

/* –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é (auth-choice-screen —É–∂–µ –≤–∏–¥–∏–º) */
document.addEventListener('DOMContentLoaded', ()=>{
  // –µ—Å–ª–∏ —Å—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã—Ç–∞ ‚Äî —É–∂–µ –≤–∏–¥–Ω–∞
  // –Ω–æ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä–∏–º referral param –∏ –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å, –ø–æ–∫–∞–∂–µ–º –Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–º —ç–∫—Ä–∞–Ω–µ info (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  const urlParams = new URLSearchParams(window.location.search);
  const refID = urlParams.get('ref');
  if(refID){
    // –µ—Å–ª–∏ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å –∏–∑–≤–µ—Å—Ç–µ–Ω (–≤ referrals) ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, –∏–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ—Ç–∫–∞
    if(referrals[refID]){
      // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É, –Ω–æ –Ω–µ –º–µ–Ω—è–µ–º –¥–∏–∑–∞–π–Ω
      console.log('Ref param', refID, 'is known:', referrals[refID]);
    } else {
      console.log('Ref param present but unknown:', refID);
    }
  }
});
</script>
</body>
</html>
